# Overview

The Ideal Graph Visualizer is a tool developed to help examine the intermediate
representation of C2 which is commonly referred to as the "ideal graph". It was
developed in collaboration with the University of Linz in Austria and has been
included as part of HotSpot since that was the primary target of the tool. The
tool itself is fairly general with only a few modules that contain C2 specific
elements.

*This repository contains extensions to the Ideal Graph Visualizer for the OpenJ9 JVM*

The tool is built on top of the NetBeans Platform, and requires a JDK version
between 11 and 17 (the JDKs supported by the current NetBeans Platform).

# Building and Running

The build system used for IGV is Maven. To download all required libraries and
build IGV, issue `mvn install`. To run IGV, use the `igv.sh` command; it will
put all log messages generated by the run to the file `.igv.log`.

To build and run IGV on a different JDK than the system default, set first the
`JAVA_HOME` to the appropriate directory. The same JDK version should be used
for building and running IGV.

# Usage

The JVM support is controlled by the flag `-Xjit:dumpMethodTrees`, where Testarossa IL will be dumped at the debug points controlled by the options documented in [`eclipse/omr`](https://github.com/eclipse/omr/blob/master/doc/compiler/CompilerOptions.md). Note if you do not enable logging then no method tree dumps will be generated either.

Each method and its corresponding Testarossa IL after each optimization pass will be dumped in its own file. The file has the format `TestarossaCompiler-$ID[$METHOD_SIGNATURE][$COMPILATION_LEVEL].xml` which can be broken down into:

- `$ID`: The order in which the trees are compiled
- `$METHOD_SIGNATURE`: The Java bytecode signature of the method
- `$COMPILATION_LEVEL`: The OpenJ9 optimization level that the method was compiled with.


## Defining Custom Filters

IGV has a powerful filter mechanism with which nodes and blocks can be colored,
hidden, updated, etc. according to user-defined rules. Filters are programmed in
JavaScript using a set of predefined primitives and auxiliary functions. For
more information, see the documentation in
`Filter/src/main/resources/com/sun/hotspot/igv/filter/helper.js`, the default
filters in
`ServerCompiler/src/main/resources/com/sun/hotspot/igv/servercompiler/filters`, and the OpenJ9 filters in `TestarossaCompiler/src/main/resources/org/testarossa/compiler/filters`.

More information about the tool is available at
https://wiki.openjdk.org/display/HotSpot/IdealGraphVisualizer.
